<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>A Pelican Blog - debug</title>
        <link rel="stylesheet" href="https://tinmard.github.io/theme/css/main.css" />
        <link href="https://tinmard.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="A Pelican Blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://tinmard.github.io/">A Pelican Blog </a></h1>
                <nav><ul>
                    <li><a href="/sab/index.html">SAB</a></li>
                    <li><a href="/epifar/index.html">Epifar</a></li>
                    <li><a href="/stimic/index.html">Stimic</a></li>
                    <li><a href="/cochlea/index.html">Cochlea</a></li>
                    <li><a href="/neurons/index.html">Neurons</a></li>
                    <li><a href="https://tinmard.github.io/category/eeg.html">eeg</a></li>
                    <li><a href="https://tinmard.github.io/category/misc.html">misc</a></li>
                    <li><a href="https://tinmard.github.io/category/projects.html">projects</a></li>
                    <li><a href="https://tinmard.github.io/category/python.html">python</a></li>
                    <li><a href="https://tinmard.github.io/category/software.html">software</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://tinmard.github.io/debug-edf-files.html">Debug EDF Files</a></h1>
<footer class="post-info">
        <abbr class="published" title="2010-10-04T13:39:00+00:00">
                Published: lun. 04 octobre 2010
        </abbr>

<p>In <a href="https://tinmard.github.io/category/eeg.html">eeg</a>.</p>
<p>tags: <a href="https://tinmard.github.io/tag/epifar.html">Epifar</a> <a href="https://tinmard.github.io/tag/ieeg.html">iEEG</a> <a href="https://tinmard.github.io/tag/debug.html">debug</a> <a href="https://tinmard.github.io/tag/edf.html">EDF</a> </p>
</footer><!-- /.post-info --><h1>Missing header information</h1>
<p>L'en-tête (header) des fichiers .edf contient des métadonnées sur le patient, l'hôpital... Si certaines de ces données sont absentes,
cela peut poser problème lors de l'ouverture du fichier selon le lecteur utilisé (cela ne semble pas avoir d'impact sur EEGLAB mais pose problème sur Anywave).</p>
<p>Il existe dans le logiciel <a href="https://www.teuniz.net/edfbrowser/">EDFBrowser</a> un outil permettant de modifier l'en-tête du fichier
(ou du moins le remplacer par des valeurs "nulles").</p>
<p>Une fois le logiciel installé, aller dans <em>Tools/Header Editor</em>, sélectionner le fichier qui pose problème et le sauvegarder.
Il n'est pas nécessaire de modifier les valeurs qui apparaissent. Mieux vaut ne pas modifier le fichier original.</p>
<h1>Annotation problems</h1>
<p>Ce problème peut provoquer une erreur lors de l'ouverture d'un fichier EDF dans EEGLAB via l'interface BIOSIG :</p>
<p>{% img /_images/debug/edf_files/message_erreur_annotations.png 600 %}</p>
<p>Le format EDF+ introduit la possibilité d'ajouter des annotations, pouvant correspondre à différents évènements,
stimuli, temps. Pour cela un signal est ajouté, même lorsque les annotations ne sont pas utilisées et son label est
“EDF Annotations”. Ce signal, comme tous les autres, est divisé en différents blocs en général d'une seconde.</p>
<p>Un exemple de fichier normal : le premier bloc du signal annotations démarre toujours par <strong>+0</strong> suivie de deux caractères
de code hexadécimal <strong>14</strong>, d'un autre chiffre ici <strong>0.55</strong> (durée de l’événement annoté en secondes ?) suivie du code hexa
<strong>14</strong> et de l'annotation rentrée lors de l'acquisition du signal (ici <strong>DAMIER S2</strong>) encore une fois suivie du code hexa <strong>14</strong>.</p>
<p>{% img /_images/debug/edf_files/edf_normal.png 600 %}</p>
<p>Dans le cas des fichiers posant problème, le premier bloc du signal annotation contient seulement le <strong>+0</strong> suivi de deux
codes hexa <strong>14</strong>. Il semble que l'interface BIOSIG attende une valeur de durée ainsi qu'une annotation.
Une solution possible est donc de modifier manuellement le fichier dans <a href="https://sourceforge.net/projects/hexedit/">HexEdit</a>:</p>
<p>{% img /_images/warning.png 20 %} Faire une copie du fichier avant de le modifier</p>
<ul>
<li>rentrer une durée après les deux octets de valeur hexa 14 (la valeur semble avoir aucune importance), par exemple +0.55</li>
<li>entrer un octet de valeur hexa 14</li>
<li>entrer l'annotation désirée</li>
<li>entrer un octet de valeur hexa 14</li>
</ul>
<p>Il est nécessaire de ne pas modifier la longueur du bloc, il faut donc repérer la fin du bloc d'annotations et après la modification
décrite ci-dessus, rajouter (ou supprimer) éventuellement des octets de valeur hexa 00 afin de conserver la longueur de bloc.</p>
<h2>Comment trouver le premier bloc du signal annotation ?</h2>
<p>La méthode la plus simple est de rechercher la suite d'octets de valeur hexa <strong>2B 30 14 14</strong>.
Pour cela, une fois le signal ouvert dans HexEdit, aller dans l'onglet Tools et sélectionner Find Hex… :</p>
<p>{% img /_images/debug/edf_files/search_hex_tool.png 600 %}</p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://cerco.ups-tlse.fr/">CerCo</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://tinmard.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://github.com/tinmarD">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>