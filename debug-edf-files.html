<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>A Pelican Blog - Debug EDF Files</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://tinmard.github.io/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://tinmard.github.io/theme/bootstrap.min.css" rel="stylesheet">
    <link href="https://tinmard.github.io/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="https://tinmard.github.io/theme/local.css" rel="stylesheet">
    <link href="https://tinmard.github.io/theme/pygments.css" rel="stylesheet">

    <!--TIPUE SEARCH  old -->
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Tipue-Search/5.0.0/tipuesearch.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Tipue-Search/5.0.0/tipuesearch_set.js"></script>-->
    <!--<link rel ="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Tipue-Search/5.0.0/tipuesearch.css"/>-->
    <!--<link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">-->
    <!--<script src="https://tinmard.github.io/theme/js/jquery-3.3.1.min.js"></script>-->
    <!--<script type="text/javascript" src="https://tinmard.github.io/theme/tipuesearch/tipuesearch_content.js"></script>-->
    <!--<link rel="stylesheet" href="https://tinmard.github.io/theme/tipuesearch/tipuesearch.css">-->
    <!--<script type="text/javascript" src="https://tinmard.github.io/theme/tipuesearch/tipuesearch_set.js"></script>-->
    <!--<script type="text/javascript" src="https://tinmard.github.io/theme/tipuesearch/tipuesearch.min.js"></script>-->
    <!--TIPUE SEARCH -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">
    <script src="https://tinmard.github.io/theme/tipuesearch/tipuesearch_content.js"></script>
    <link rel="stylesheet" href="https://tinmard.github.io/theme/tipuesearch/tipuesearch.css">
    <!--<script src="tipuesearch/tipuesearch_set.js"></script>-->
    <!--<script src="tipuesearch/tipuesearch.min.js"></script>-->
    <script src="https://tinmard.github.io/theme/tipuesearch/tipuesearch_set.js"></script>
    <script src="https://tinmard.github.io/theme/tipuesearch/tipuesearch.min.js"></script>


    <!-- So Firefox can bookmark->"abo this site" -->
        <link href="https://tinmard.github.io/feeds/all.atom.xml" rel="alternate" title="A Pelican Blog" type="application/atom+xml">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="https://tinmard.github.io">A Pelican Blog</a>

        <div class="nav-collapse">
        <ul class="nav">
            <li><a href="/sab/index.html">SAB</a></li>
            <li><a href="/epifar/index.html">Epifar</a></li>
            <li><a href="/stimic/index.html">Stimic</a></li>
            <li><a href="/cochlea/index.html">Cochlea</a></li>
            <li><a href="/neurons/index.html">Neurons</a></li>

        </ul>
        </div>

        <!--TIPUE SEARCH old-->
        <!--<div style="float:right; padding-right:100px;">-->
            <!--<form action="https://tinmard.github.io/search.html" onsubmit="return this.elements['q'].value;">-->
              <!--<input id="tipue_search_input" type="text" name="q" placeholder="Search">-->
            <!--</form>-->
        <!--</div>-->
        <form>
            <div class="tipue_search_group">
              <input type="text" name="q" id="tipue_search_input" pattern=".{3,}" title="At least 3 characters" required><button type="submit" class="tipue_search_button"><div class="tipue_search_icon">&#9906;</div></button>
            </div>
        </form>

<div id="tipue_search_content"></div>

    </div>
    </div>
</div>


<div class="container">

    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>Debug EDF Files</h1>
lun. 04 octobre 2010

 


        </div>

	
        <div><h1>Missing header information</h1>
<p>L'en-tête (header) des fichiers .edf contient des métadonnées sur le patient, l'hôpital... Si certaines de ces données sont absentes,
cela peut poser problème lors de l'ouverture du fichier selon le lecteur utilisé (cela ne semble pas avoir d'impact sur EEGLAB mais pose problème sur Anywave).</p>
<p>Il existe dans le logiciel <a href="https://www.teuniz.net/edfbrowser/">EDFBrowser</a> un outil permettant de modifier l'en-tête du fichier
(ou du moins le remplacer par des valeurs "nulles").</p>
<p>Une fois le logiciel installé, aller dans <em>Tools/Header Editor</em>, sélectionner le fichier qui pose problème et le sauvegarder.
Il n'est pas nécessaire de modifier les valeurs qui apparaissent. Mieux vaut ne pas modifier le fichier original.</p>
<h1>Annotation problems</h1>
<p>Ce problème peut provoquer une erreur lors de l'ouverture d'un fichier EDF dans EEGLAB via l'interface BIOSIG :</p>
<p>{% img /_images/debug/edf_files/message_erreur_annotations.png 600 %}</p>
<p>Le format EDF+ introduit la possibilité d'ajouter des annotations, pouvant correspondre à différents évènements,
stimuli, temps. Pour cela un signal est ajouté, même lorsque les annotations ne sont pas utilisées et son label est
“EDF Annotations”. Ce signal, comme tous les autres, est divisé en différents blocs en général d'une seconde.</p>
<p>Un exemple de fichier normal : le premier bloc du signal annotations démarre toujours par <strong>+0</strong> suivie de deux caractères
de code hexadécimal <strong>14</strong>, d'un autre chiffre ici <strong>0.55</strong> (durée de l’événement annoté en secondes ?) suivie du code hexa
<strong>14</strong> et de l'annotation rentrée lors de l'acquisition du signal (ici <strong>DAMIER S2</strong>) encore une fois suivie du code hexa <strong>14</strong>.</p>
<p>{% img /_images/debug/edf_files/edf_normal.png 600 %}</p>
<p>Dans le cas des fichiers posant problème, le premier bloc du signal annotation contient seulement le <strong>+0</strong> suivi de deux
codes hexa <strong>14</strong>. Il semble que l'interface BIOSIG attende une valeur de durée ainsi qu'une annotation.
Une solution possible est donc de modifier manuellement le fichier dans <a href="https://sourceforge.net/projects/hexedit/">HexEdit</a>:</p>
<p>{% img /_images/warning.png 20 %} Faire une copie du fichier avant de le modifier</p>
<ul>
<li>rentrer une durée après les deux octets de valeur hexa 14 (la valeur semble avoir aucune importance), par exemple +0.55</li>
<li>entrer un octet de valeur hexa 14</li>
<li>entrer l'annotation désirée</li>
<li>entrer un octet de valeur hexa 14</li>
</ul>
<p>Il est nécessaire de ne pas modifier la longueur du bloc, il faut donc repérer la fin du bloc d'annotations et après la modification
décrite ci-dessus, rajouter (ou supprimer) éventuellement des octets de valeur hexa 00 afin de conserver la longueur de bloc.</p>
<h2>Comment trouver le premier bloc du signal annotation ?</h2>
<p>La méthode la plus simple est de rechercher la suite d'octets de valeur hexa <strong>2B 30 14 14</strong>.
Pour cela, une fois le signal ouvert dans HexEdit, aller dans l'onglet Tools et sélectionner Find Hex… :</p>
<p>{% img /_images/debug/edf_files/search_hex_tool.png 600 %}</p></div>
	
        <hr>

    </div>
        </div>

        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Site
                </li>

                <li><a href="https://tinmard.github.io/archives.html">Archives</a>
                <li><a href="https://tinmard.github.io/tags.html">Tags</a>



                <li><a href="https://tinmard.github.io/feeds/all.atom.xml" rel="alternate">Atom feed</a></li>

            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Categories
                </li>

                <li><a href="https://tinmard.github.io/category/eeg.html">eeg</a></li>
                <li><a href="https://tinmard.github.io/category/misc.html">misc</a></li>
                <li><a href="https://tinmard.github.io/category/projects.html">projects</a></li>
                <li><a href="https://tinmard.github.io/category/python.html">python</a></li>
                <li><a href="https://tinmard.github.io/category/software.html">software</a></li>
            </ul>
            </div>





        </div>     </div>     </div> 

<footer>
<br />
<p><a href="https://tinmard.github.io">A Pelican Blog</a> &copy;  2018</p>
</footer>
</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://tinmard.github.io/theme/bootstrap-collapse.js"></script>
</body>
</html>